\chapter{Conclusions}
\label{sec:conclusions}

This project has compared BTF and SLEVE terrain following grids with the `SnapCol' grid which approximates a piecewise linear cut cell grid.   Numerical errors have been analysed for a variety of two-dimensional test cases, solving the fully-compressible Euler equations and the linear advection equation.

The model's upwind-biased cubic advection scheme, introduced in section~\ref{sec:method:discretisation}, was tested in the horizontal advection of a tracer in section~\ref{sec:advection}.  Tracer shape was maintained on all grids and tracer magnitude was well-preserved on all except the BTF grid.  In line with existing studies, the most accurate results were found on the SnapCol grid, having errors comparable to those on a regular grid without orography.  Errors were largest on the BTF grid, with artefacts remaining above the mountain, and mild distortion as the tracer passed over the mountain, though accuracy was nevertheless better than the BTF result from \textcite{schaer2002}.

In section~\ref{sec:wobblyTracerAdvection}, a second advection test was designed to determine if advection errors are caused by non-uniformity and skewness, or by misalignment of the flow with grid layers.  To this end, a velocity field was formulated that follows the layers of the BTF grid.
Errors on the BTF grid were greatly reduced, but the result on the SnapCol grid was the worst of all the tracer advection tests with tracer magnitude significantly reduced.  Therefore, we conclude that advection errors are caused by flow crossing grid layers, since accuracy was greatest on the non-orthogonal BTF grid.  The lack of monotonicity of the advection scheme motivates the introduction of a flux limiter, and this is discussed in section~\ref{sec:further-work:advection}.

\TODO{over orography.  what was its motivation?} In the resting atmosphere test presented in section~\ref{sec:resting}, spurious vertical velocities on the SLEVE grid were comparable to the same result from \textcite{schaer2002}, but offered only a small improvement compared to the BTF grid.  Vertical velocity was reduced by almost three orders of magnitude on the SnapCol grid.  Spurious velocities on the regular grid were still higher than the result on a cut cell grid from \textcite{good2013}, and this is the subject of further work in section~\ref{sec:further-work:resting}.

Energy was well-conserved on all grids with energy slowly decreasing on the SnapCol grid and a regular grid with flat terrain.  However, periods of energy gain were found on BTF and SLEVE grids which require further work to diagnose the source.

In section~\ref{sec:gw}, orographically induced gravity waves were modelled.  Velocity fields were qualitatively very similar across all grids, and vertical velocity contours agreed with the mass-conserving semi-implicit semi-Lagrangian result from \textcite{melvin2010}.  Little evidence of the `small cell' problem was found and we argue that, because the flow is mainly horizontal, this has negligible effect on the Courant number in thin cells.

Potential temperature anomalies in the gravity waves test were also visually similar, except near the ground in the lee of the mountain on the SnapCol grid.  Potential temperatures were anomalously high in the lowest layer, and anomalously low in the layer immediately above, whilst no such anomalies were present in the Exner profile.  This is a typical manifestation of the Lorenz computational mode in which discrete hydrostatic balance is preserved despite a `zig-zag' in potential temperature.
The magnitude of these anomalies increased on the SnapCol grid when the mountain height was doubled, but results on the TF grids were largely unaffected.

A final test was designed to investigate the cause of these potential temperature anomalies (section~\ref{sec:wobblyThetaAdvection}.  We hypothesised that errors in the advection scheme excited the Lorenz computational mode.  The same thermal profile was advected using a terrain following velocity field that imitates the velocity field in the gravity waves test.  Once again, potential temperature anomalies were found in the lowest two layers in the lee of the mountain.  However, in this advection test, the anomalies were reversed with the anomalously low potential temperatures in the lowest layer.  It is possible that the structure of errors differ because the velocity fields in the gravity waves test and the thermal advection test were not the same.  Further tests are required to be certain of the cause of the Lorenz computational mode, and this is discussed in section~\ref{sec:further-work:gw}.
