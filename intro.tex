\chapter{Introduction}

Orography has significant effects on local weather, creating strong downslope winds and enhancing local precipitation \autocite{barry2008}.  Terrain also affects global circulation by exerting low-level drag \autocite{lott-miller1997} and transporting momentum via gravity waves \autocite{mcfarlane1987}.

To capture these effects, numerical weather prediction (NWP) models must solve the equations of motion on a grid that represents the orography.  There are two main approaches: transform the coordinates so that the domain becomes rectangular, or use Cartesian coordinates and apply special treatment to the lower boundary \autocite{galchen-somerville1975}.

Terrain following (TF) coordinates are in widespread use in operational models.  In this transformed coordinate system the terrain's influence decays with height: the bottommost layers follow the underlying surface closely while the uppermost layers are flat.  It is well-known that TF coordinates perform badly in the presence of steep orography.  As spatial resolution in NWP models increases, gradients in terrain become steeper.  This leads to greater errors in the horizontal pressure gradient which results in spurious winds \autocite{dempsey-davis1998}.  Much work has been done to reduce error associated with TF coordinates: firstly, by smoothing the effects of terrain with height and, secondly, by improving the accuracy of the horizontal pressure gradient itself.

\textcite{galchen-somerville1975} proposed a basic terrain following (BTF) coordinate system, defined as
\begin{align}
z = \left( H - z_s \right) \frac{Z}{H} + z_s
\end{align}
where, in two dimensions, $z(x, Z)$ is the height of the coordinate surface at level $Z$, $H$ is the height of the domain, and $z_s(x)$ is the height of the terrain surface.  \TODOsidenote{maybe move this maths into a later section (since we're actually running tests on BTF grid)} \TODOsidenote{should I stick with Klemp's notation? I was planning on using z/Z and relating this to transform theory/Jacobian stuff.}  The terrain's influence decays linearly with height but disappears only at the top of the domain.

The hybrid terrain following (HTF) coordinates of \textcite{simmons-burridge1981} improve upon BTF coordinates by allowing the vertical decay profile can be controlled.  By choosing a suitable profile, terrain influence decays more rapidly than BTF to produce surfaces of constant height aloft \autocite{klemp2011}.

The coordinate system can be further refined by decaying small-scale features more rapidly than large-scale features to produce smooth coordinate surfaces in the middle and top of the domain.  \textcite{schaer2002} achieved this with smooth level vertical (SLEVE) coordinates in which terrain height is split into small-scale and large-scale components, each having different exponential decay profiles.  \TODOsidenote{if I'm going to include results from SLEVE grid, I'll have to say more about how it works}  \textcite{klemp2011} took an alternative approach, using a multipass smoothing operator, and found that errors were reduced still further compared to SLEVE.

\TODO{The other approach of improving accuracy of pressure gradient (Klemp 2011, Mahrer 1984, Zaengl 2012)}

Despite their associated numerical errors, TF coordinates are attractive because they simplify the lower boundary condition, their rectangular structure is simple to process by computer \autocite{schaer2002}, and cell sizes remain almost constant \autocite{jebens2011}.

In contrast, Cartesian coordinate grids have cells of varying sizes immediately above the ground.  The step-mountain coordinate proposed by \textcite{mesinger1988} removes cells that are intersected by the terrain so creating steps over the surface.  \TODOsidenote{is this really cartesian (Good et al 2013 suggest it is) or is it a coord transform (seems to be according to Mesinger1988)?}  \textcite{gallus-klemp2000} found that lee slope winds are too weak over smooth orography, but this study did not examine performance over steep terrain.  In contrast, \textcite{mesinger2004} compared results from three operational NCEP models that suggested the step-coordinate model was more skillful than the TF coordinate models in forecasting precipitation over the mountainous western United States.

\TODO{worth mentioning partial step next?}

The cut cell (or `shaved cell')  method is another alternative to terrain following coordinates.  Here, the surface terrain is intersected with a regular Cartesian grid such that cells are cut where they intersect with the ground.   The primary difficulty is with numerical stability and reduced model efficiency associated with small cells. \TODOsidenote{another disadvantage: boundary layer parameterisations (Zaengl 2012)}

A variety of solutions to the `small cell problem' have been proposed.  In \textcite{yamazaki-satomura2010}, small cells are combined with horizontally or vertically adjacent cells.  \TODOsidenote{should I discuss result of each of these techniques?} \TODOsidenote{Good et al 2013 say that Y\&S2010 found you could increase the timestep tenfold.  But I see no mention of this in the paper}  \textcite{steppeler2002} use a `thin-wall' approximation to increase the computational volume of small cells without altering the terrain.  Conceptually, each cell partially or completely below the mountain is filled with air and surrounded by a thin wall.  Where a cell is cut by the terrain, the computational volume is equal to that of an uncut cell.  \textcite{jebens2011} avoid the timestep restriction associated with explicit schemes by using an implicit method for cut cells and a semi-explicit method elsewhere.

Several studies found that cut cells are produce more accurate results when compared to TF coordinates.  Spurious winds seen in TF coordinates are not present and errors do not increase with horizontal resolution \autocite{good2013}.  Cut cells have been found to be more accurate with steep terrain in several experiments \parencites{good2013}{yamazaki-satomura2010}.  A comparison of TF and cut-cells using real initial data by \textcite{steppeler2006} found that precipitation patterns, temperature and wind fields were forecast more accurately in the cut-cell model, and the weak lee slope winds found by \textcite{gallus-klemp2000} in the step-mountain coordinate model were not present.  
\TODOsidenote{look at Fast 2003 and refs therein for more cut-cell goodness}

\TODO{unstructured meshes are possible, harder to calculate vertically when gravity dominates (Rosatti 2005)}

% BTF
% SLEVE
% cut cells
%This leads to cells that are entirely above the surface, entirely below it, and those which intersect with the ground.  Those cells which intersect the ground have, in two dimensions, a triangular, trapezoidal or pentagonal shape\autocite{rosatti2005}. 
%The primary difficulty with this method is the timestep restrictifor explicit schemes imposed by the Courant–Friedrichs–Lewy (CFL) criterion associated with small cut cells.

\TODO{talk about finite volume technique (adcroft 1997 has some nice stuff) and CFL constraint.}
