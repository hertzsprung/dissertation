\chapter{Introduction}

Orography has significant effects on local weather, creating strong downslope winds and enhancing local precipitation \autocite{barry2008}.
Large mountain ranges also affect global circulation.  A mountain acts as a barrier to air flow and, due to conservation of vorticity, meridional displacement balances vortex stretching, giving rise to planetary waves which affect the development of pressure systems \autocite{barry2008}.
The Tibetan Plateau acts as an elevated heat source, raising temperatures and humidity in summer which help to maintain the Asian monsoon \parencites{ye1981}{luo-yanai1983}.
Terrain also affects global circulation by exerting low-level drag \autocite{lott-miller1997} and transporting momentum via gravity waves \autocite{mcfarlane1987}.

To capture these effects, numerical weather prediction (NWP) models must solve the equations of motion on a grid that represents the orography.
Over flat ground the grid can be entirely regular, but in the presence of sloping terrain the grid must be modified.  There are two main approaches: either transform the grid so that its vertical layers follow the terrain, or remove all or part of grid cells that intersect with the orography.

Terrain following (TF) layers are in widespread use in operational models and are usually implemented on a rectangular computational grid, using terrain following vertical coordinates instead of Cartesian coordinates.  In this system, the terrain's influence decays with height: the bottommost layers follow the underlying surface closely while the uppermost layers are flat.

It is well-known that TF coordinates perform badly in the presence of steep orography \autocite{gary1973}.  As spatial resolution in NWP models increases, gradients in terrain tend to become steeper \autocite{steppeler2002}.  This leads to larger truncation errors in calculating the horizontal pressure gradient which result in spurious winds \autocite{dempsey-davis1998}.  Much work has been done to reduce error associated with TF coordinates: firstly, by smoothing the effects of terrain with height \parencites{simmons-burridge1981}{schaer2002}{leuenberger2010}{klemp2011} and, secondly, by improving the accuracy in calculating the horizontal pressure gradient itself \parencites{mahrer1984}{klemp2011}{zaengl2012}.

Despite their associated numerical errors, TF coordinates are attractive because their rectangular structure is simple to process by computer, boundary layer resolution can be increased with variable spacing of vertical layers \autocite{schaer2002}, and cell sizes remain almost constant \autocite{jebens2011}.

An alternative to terrain following layers is to `shave', or `cut', cells where they intersect with the terrain surface.  Cells that lie entirely below the terrain are removed, and those that intersect the surface are modified in shape so that they more closely fit the terrain.  This modification means that some cells become very small, which can reduce computational efficiency \autocite{klein2009}, and several approaches have been tried to alleviate the problem \parencites{steppeler2002}{yamazaki-satomura2010}{jebens2011}.

Several studies found that cut cells produce more accurate results when compared to TF coordinates.  Spurious winds seen in TF coordinates are not present and errors do not increase with steeper terrain \autocite{good2013}.  A comparison of TF and cut cells using real initial data by \textcite{steppeler2006} found that precipitation patterns, temperature and wind fields were forecast more accurately in the cut cell model.  

Other representations of terrain have been developed using unstructured grids \parencites{ss2011}{pain2005}.  They are able to represent the boundary accurately, but more complex discretisations are required to maintain accuracy because the mesh is not aligned with the dominant vertical force of gravity \autocite{rosatti2005}, just as horizontal pressure gradients are difficult to calculate in TF coordinates.

Unstructured grids can be combined with dynamic mesh adaptation so that small scale features can be resolved in areas of interest, such as regions of frontogenesis, inversion layers, and the boundary layer \autocite{browne2014}.  Dynamically adaptive meshes reduce the number of grid cells needed to represent small scale features, but updating the mesh can take a significant amount of computation time \parencites{blaise2012}{browne2014}.  Furthermore, mesh adaptation does not necessarily lead to a more accurate model \autocite{parkinson2014}.

\section{Project outline}
This project aims to compare the accuracy of TF and cut-cell style grids in a variety of two-dimensional test cases.   Simulations are performed using the OpenFOAM CFD library \autocite{openfoam} with a finite volume discretisation of the fully compressible Euler equations from \textcite{weller-shahrokhi2014}.  The model includes a curl-free pressure gradient formulation, an upwind-biased cubic advection scheme, and a Lorenz vertical staggering of variables.  All tests are performed using the same model on TF and cut cell style grids, enabling like-for-like comparison between grids.

In chapter~\ref{sec:theory}, the theory of coordinate transforms is introduced and applied to a discretisation of the horizontal pressure gradient.  We review the main types of terrain following transformations and present three shaving techniques used to construct cut cell grids.  The finite volume method and the Lorenz and Charney--Phillips vertical staggerings are outlined.  We end the chapter with a brief description of the linear theory of gravity waves that is later used to evaluate test experimental results.

In chapter~\ref{sec:method}, we describe the method of grid construction using the OpenFOAM CFD library.  An overview of the model discretisation from \textcite{weller-shahrokhi2014} is given and its curl-free pressure gradient and upwind-biased cubic advection scheme are described.  The chapter concludes by describing the calculation of energy measures and the Courant--Friedrichs--Lewy criterion on an unstructured grid.

The results of five experiments are discussed in chapter~\ref{sec:results}.  Results of three standard test cases are compared with results from the literature, and two new test cases are developed which shed light on some problems with cut cells.  The first two tests challenge the upwind-biased advection scheme.  The first, standard test transports a tracer in a horizontal flow.  The second test is formulated to find the cause of errors in the horizontal advection test, by transporting a tracer in a terrain following flow.  The third test examines spurious motion in a resting atmosphere in the presence of orography.  The fourth test generates orographically induced gravity waves and errors in potential temperature found on the cut cell style grid are discussed.  A final test is developed to investigate the cause of this error by advecting a stable thermal profile.

Concluding remarks on the experimental results are made in chapter~\ref{sec:conclusions}.  Finally, areas of further work are discussed in chapter~\ref{sec:further-work}.  Additional tests are suggested to explore the source of numerical errors that were found in the experimental results.  In particular, we recommend the formulation of a new Charney--Phillips staggering on unstructured grids.  We hope that, by modifying the model to use this staggering, numerical error would be reduced.
