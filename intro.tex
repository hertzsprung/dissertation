\chapter{Introduction}

Orography has significant effects on local weather, creating strong downslope winds and enhancing local precipitation \autocite{barry2008}.  Terrain also affects global circulation by exerting low-level drag \autocite{lott-miller1997} and transporting momentum via gravity waves \autocite{mcfarlane1987}.  \TODO{also planetary waves and "elevated heat sources", e.g. Tibetan plateau}

To capture these effects, numerical weather prediction (NWP) models must solve the equations of motion on a grid that represents the orography.
Over flat ground the grid can be entirely regular, but in the presence of sloping terrain the grid must be modified.  There are two main approaches: either transform the grid so that its vertical layers follow the terrain, or remove all or part of grid cells that intersect with the orography.

Terrain following (TF) layers are in widespread use in operational models and are usually implemented on a rectangular computational grid, using terrain following vertical coordinates instead of Cartesian coordinates.  In this system, the terrain's influence decays with height: the bottommost layers follow the underlying surface closely while the uppermost layers are flat.

It is well-known that TF coordinates perform badly in the presence of steep orography \autocite{gary1973}.  As spatial resolution in NWP models increases, gradients in terrain tend to become steeper \autocite{steppeler2002}.  This leads to greater errors in the horizontal pressure gradient which results in spurious winds \autocite{dempsey-davis1998}.  Much work has been done to reduce error associated with TF coordinates: firstly, by smoothing the effects of terrain with height \parencites{simmons-burridge1981}{schaer2002}{leuenberger2010}{klemp2011} and, secondly, by improving the accuracy of the horizontal pressure gradient itself \parencites{mahrer1984}{klemp2011}{zaengl2012}.

Despite their associated numerical errors, TF coordinates are attractive because their rectangular structure is simple to process by computer, boundary layer resolution can be increased with variable spacing of vertical layers \autocite{schaer2002}, and cell sizes remain almost constant \autocite{jebens2011}.

An alternative to terrain following layers is to `shave', or `cut', cells where they intersect with the terrain surface.  Cells that lie entirely below the terrain are removed, and those that intersect the surface are modified in shape so that they more closely fit the terrain.  This modification means that some cells become very small, which can reduce computational efficiency \autocite{klein2009}, and several approaches have been tried to alleviate the problem \parencites{steppeler2002}{yamazaki-satomura2010}{jebens2011}.

Several studies found that cut cells produce more accurate results when compared to TF coordinates.  Spurious winds seen in TF coordinates are not present and errors do not increase with steeper terrain \autocite{good2013}.  A comparison of TF and cut cells using real initial data by \textcite{steppeler2006} found that precipitation patterns, temperature and wind fields were forecast more accurately in the cut cell model, and the weak lee slope winds found by \textcite{gallus-klemp2000} in the step-mountain coordinate model were not present.  

%\textcite{adcroft1997} evaluated three shaving techniques for modelling the ocean surface.  First, the `full-step` technique in which the surface is rounded to the nearest vertical level.  Second, a `partial-step' method which allows the cell height to vary so that cell volumes are more accurately represented.  Third, the piecewise linear method which creates cells of different shapes where they intersect with the ground.  Examples of these three methods are shown in figure~\ref{fig:intro:shaved}.  \textcite{adcroft1997} found that spurious oscillations in a tracer advection test were reduced by using a partial-step grid, and that numerical noise was almost entirely removed on the piecewise linear cut cell grid.

\TODOsidenote{look at Fast 2003 and refs therein for more cut-cell goodness}

Other representations of terrain have been developed using unstructured grids \parencites{ss2011}{others?}.  \TODO{see Pain2005}  They are able to represent the boundary accurately but, because they require a more complex data representation compared to structured grids, they can be difficult to partition for parallel computation \autocite{steppeler2003}.  More complex discretisations are required to maintain accuracy because the mesh is not aligned with the dominant vertical force of gravity \autocite{rosatti2005}, just as horizontal pressure gradients are difficult to calculate in TF coordinates.

\TODO{Worth talking about nested grids?  e.g. Almgren 1998}

\TODO{talk about the advantages of adaptive grids.  Steppeler 2003 says a bit, Blaise 2012 says they can capture range of spatial scales while improving computational efficiency.  Can I find an example in literature of adaptive meshing to follow the flow? Almgren 1998 looks interesting, for example.} 

\section{Project outline}
This project aims to compare the accuracy of TF and cut-cell style grids in a variety of two-dimensional test cases.   Simulations are performed using the OpenFOAM CFD library \autocite{openfoam} with a finite volume discretisation of the fully compressible Euler equations from \textcite{weller-shahrokhi2014}.  \TODO{more on this when I've written the rest!}
\TODO{like-for-like comparison, excellent new curl-free pressure gradient formulation, test cases not chosen to show off particular grid} 

In chapter~\ref{sec:theory}, the theory of coordinate transforms is introduced and applied to a discretisation of the horizontal pressure gradient.  We review the main types of terrain following transformations and present three shaving techniques used to construct cut cell grids.  The finite volume method and the Lorenz and Charney--Phillips vertical staggerings are outlined.

In chapter~\ref{sec:method}, we describe the method of grid construction using the OpenFOAM CFD library.  An overview of the model discretisation from \textcite{weller-shahrokhi2014} is given and its curl-free pressure gradient and upwind-biased cubic advection scheme are described.  The chapter concludes by describing the calculation of energy measures and the Courant--Friedrichs--Lewy criterion on an unstructured grid.

The results of five experiments are discussed in chapter~\ref{sec:results}.  The first two tests challenge the upwind-biased advection scheme by transporting a tracer in horizontal and terrain following flows.  The third test examines spurious motion in a resting atmosphere.  The fourth test generates orographically induced gravity waves and errors in potential temperature found on the cut cell style grid are discussed.  The final test confirms that the potential temperature anomalies are due to errors in the advection scheme exciting the computational mode in the Lorenz vertical staggering.

\TODO{conclusions and further work}
