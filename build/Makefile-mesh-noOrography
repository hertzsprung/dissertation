# $(1) -- boundary-specific case path
# $(2) -- subproject label (e.g. mesh-noOrography-advection)
# $(3) -- blockMeshDict file
define BLOCK_MESH_TEMPLATE

  $(eval $(call MESH_TEMPLATE,$(1),$(2)))

  .INTERMEDIATE: $(2).intermediate

  $(addprefix $(1)/,$(MESH_FILES)): $(2).intermediate

  $(2).intermediate: \
    $(1)/$(BLOCK_MESH_DICT) \
    $(addprefix $(1)/,$(SYSTEM_FILES))
	$(BLOCK_MESH) -case $(1) > $(2).blockMesh.log

  $(1)/$(BLOCK_MESH_DICT): $(3) | $(1)/$(POLY_MESH_DIR)
	$(CP) $(3) $(1)/$(BLOCK_MESH_DICT)

endef

$(eval $(call BLOCK_MESH_TEMPLATE,openfoam/cases/mesh/noOrography/advection,mesh-noOrography-advection,openfoam/cases/mesh/noOrography/blockMeshDictAdvection))

$(eval $(call BLOCK_MESH_TEMPLATE,openfoam/cases/mesh/noOrography/resting,mesh-noOrography-resting,openfoam/cases/mesh/noOrography/blockMeshDictResting))

$(eval $(call BLOCK_MESH_TEMPLATE,openfoam/cases/mesh/noOrography/gravityWaves,mesh-noOrography-gravityWaves,openfoam/cases/mesh/noOrography/blockMeshDictGravityWaves))

clean:: \
  clean-mesh-noOrography-advection \
  clean-mesh-noOrography-resting
