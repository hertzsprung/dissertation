\chapter{Further work} \label{sec:further-work}
The results of the five experiments from chapter~\ref{sec:results} motivate several routes of further work.  Before discussing these, however, we identify three other items worthy of study.

First, in order to compare results with those from other experiments, such as \textcite{good2013}, the SnapCol grid should be improved so that all cut cells are aligned in rows and columns.  As discussed in section~\ref{sec:method:grid}, some cells that intersect the surface are slightly distorted during the construction of the SnapCol grid.

Second, all experiments were performed on in Cartesian coordinates and, unlike most existing implementations of terrain following layers, no coordinate transform was used.  We should investigate the metric terms introduced by terrain following coordinates, and determine whether a discretisation with metric terms can be mathematically equivalent to the Cartesian coordinate discretisation.

Third, it is desirable to perform additional verification of the model of \textcite{weller-shahrokhi2014} using idealised simulations on regular grids without orography.  Following the set of test cases for nonhydrostatic models proposed by \textcite{skamarock2004}, two further tests might be undertaken.  First, following \textcite{skamarock-klemp1994}, a simulation of the evolution of gravity waves from a potential temperature anomaly in a stable atmosphere with a horizontal wind.  Second, following \textcite{straka1993}, a cold bubble sinks to the ground, creating a density current that travels horizontally.  Results of both tests should be compared with reference solutions from \textcite{skamarock-klemp1994} and the results of \textcite{jebens2011}.

\section{Advection scheme}
\label{sec:further-work:advection}

For the three advection tests described in sections~\ref{sec:advection}, \ref{sec:wobblyTracerAdvection} and \ref{sec:wobblyThetaAdvection}, the standard OpenFOAM advection solver was used, which has two shortcomings.  First, whilst advection is treated explicitly in the fully-compressible model from \textcite{weller-shahrokhi2014}, the scalar transport model solves the advection equation (equation~\ref{eq:advection:continuous}) using implicit time-stepping.  Second, the velocity fields for the three advection tests had velocities stored at cell centres.  The scalar transport model introduces additional error when velocities are linearly interpolated onto cell faces during model initialisation\footnote{For details, refer to \url{https://github.com/OpenFOAM/OpenFOAM-2.3.x/blob/9fd0db/src/finiteVolume/cfdTools/incompressible/createPhi.H}}.

To avoid these two issues, a custom scalar transport model should be implemented that solves the advection equation explicitly and accepts a field in which velocities are defined at cell faces.  This has the added advantage that any velocity field from any fully-compressible simulation, such as the gravity waves test from section~\ref{sec:gw}, can be used as the prescribed velocity field for an advection test.

The upwind-biased cubic advection scheme, described in section~\ref{sec:method:discretisation}, is not monotonic.  Results from horizontal and terrain following tracer advection tests showed that minimum and maximum tracer values decreased over time (see sections~\ref{sec:advection} and \ref{sec:wobblyTracerAdvection}).
In similar tracer advection experiments, \textcite{jones2013} found that the van Leer scheme gave most accurate results.  The scheme is designed to maximise boundedness and accuracy, blending a centred difference scheme that is second-order accurate and unbounded with an upwind scheme that is first-order accurate and bounded.  This motivates the development of a monotonicity preserving version of the upwind-biased cubic advection scheme.  Due to its larger stencil size, we would expect such a scheme to have greater accuracy compared to the current upwind-biased scheme, and the van Leer scheme used by \textcite{jones2013}.

Results from horizontal and terrain following tracer advection tests also showed that accuracy was greatest when the velocity field was aligned with the grid.  This motivates further tests using an adaptive mesh that is dependent upon the flow.  An adaptive mesh redistribution technique might be employed such as the three dimensional formulation by \textcite{browne2014}.

\section{Resting atmosphere errors}
\label{sec:further-work:resting}

Three findings from the resting atmosphere test (section~\ref{sec:resting}) have yet to be understood.  First, compared to the results of \textcite{good2013}, the maximum vertical velocity on a regular grid is larger than expected (figure~\ref{fig:resting:w:model}) which may be due to loss of precision when loading the initial conditions.
Second, computational oscillations in vertical velocity were found on the BTF grid which eventually lead to numerical instability (not shown).  This error has not been seen on any other grid, nor in any other test case.
Third, whilst total energy gradually decreased on the SnapCol and regular grids, some energy gain was seen on the BTF and optimised SLEVE grids.  Given that energy continued to increase on the BTF grid, we would expect this to contribute to the numerical instability.

Therefore, further work is required using longer integration times to diagnose the errors in this test and, in particular, more effort is needed to understand the lack of energy conservation.  Additionally, two more resting atmosphere tests should be carried out.  First, the mountain height should be increased from \SI{1}{\kilo\meter} to \SI{4}{\kilo\meter} for comparison with results from \textcite{zaengl2012} and \textcite{good2013}.  Second, a test of a neutrally stable atmosphere at rest by \textcite{botta2004} found that errors were close to machine precision but that errors increased when stratification was included.  Comparisons with this test would be useful to further explore the sources of numerical error in idealised resting atmospheres.

\section{Gravity waves and potential temperature errors}
\label{sec:further-work:gw}

The results of terrain following advection of a stable thermal profile (section~\ref{sec:wobblyThetaAdvection}) showed a different potential temperature error structure compared to those on the SnapCol grid in the gravity waves test (section~\ref{sec:gw}).  These results could be different because the velocity fields in the two tests are not the same.

Instead of a prescribing an idealised velocity field, a further advection test might be developed that uses a velocity field more similar to the gravity waves simulation.
The gravity waves velocity field on the BTF grid might be taken as the prescribed velocity field in the new advection test.  The custom transport model, discussed earlier in this chapter, would make this straightforward on the BTF grid.  However, velocities would have to be interpolated from the BTF grid onto the SnapCol grid.  We could not simply prescribe the SnapCol velocity field from the gravity waves test because the velocity field itself may contain errors.

By using a more physical velocity field we hope that the new advection test would produce the same potential temperature error structure as the errors on the SnapCol grid in the gravity waves test.  This result would confirm that the Lorenz computational mode is excited by errors in the advection of potential temperature.

To further investigate the Lorenz computational mode found on the SnapCol grid in the gravity waves test, a Charney--Phillips staggering should be formulated and implemented for unstructured grids.  We hypothesise that the potential temperature errors near the ground on the lee slope would be reduced on a Charney--Phillips grid since stationary oscillations in the potential temperature field would not be maintained.

Little evidence of the small cell problem was found in the gravity waves test.  The Courant number was shown to be independent of horizontal velocity and, because flow is near-horizontal in the gravity waves test, there was no small cell problem.  To confirm this hypothesis, another test might be constructed in which a cold thermal anomaly descends onto a mountain.  This test is similar to density current from \textcite{straka1993} but includes a mountain profile.  The vertical momentum that reaches the surface should, for a sufficiently large timestep, cause numerical instability on the SnapCol grid but a stable solution on terrain following grids.  This would motivate the merging of small cells following \textcite{yamazaki-satomura2010}.

All tests presented in this project use one of two wave-shaped mountain profiles (given by equations~\ref{eqn:advection:schaerCos} and \ref{eqn:resting:mountain}).  Many experiments on cut cell grids perform simulations over bell-shaped mountain profiles known as `Witch of Agnessi' \parencites{steppeler2002}{rosatti2005}{klein2009}{jebens2011}.  Following \textcite{gallus-klemp2000}, a further test should be developed to simulate flow over a the bell-shaped mountain profile to allow comparison with existing results.

\textcite{lock2012} extended the two-dimensional test from \textcite{gallus-klemp2000} to simulate flow over a three dimensional mountain, presenting results on a cut cell grid.  It would be valuable to compare model results for terrain following and cut cell grids in three dimensions.
