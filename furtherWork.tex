\chapter{Further work}
\label{sec:further-work}

The results of the five experiments from chapter~\ref{sec:results} motivate several routes of further work.  Before discussing these, however, we identify three other items worthy of study.

First, in order to compare results with those from other experiments, such as \textcite{good2013}, the SnapCol grid should be improved so that all cut cells are aligned in columns.  As discussed in section~\ref{sec:method:grid}, some cells that intersect the surface are slightly distorted during the construction of the SnapCol grid.

Second, all experiments were performed on in Cartesian coordinates and, unlike most existing implementations of terrain following layers, no coordinate transform was used.  We should investigate the metric terms introduced by terrain following coordinates, and determine whether a discretisation with metric terms is mathematically equivalent to the Cartesian coordinate discretisation.

Third, it is desirable to perform additional verification of the model of \textcite{weller-shahrokhi2014} using idealised simulations on regular grids without orography.  Following the set of test cases for nonhydrostatic models proposed by \textcite{skamarock2004}, two further tests might be developed.  First, following \textcite{skamarock-klemp1994}, a simulation of the evolution of gravity waves from a potential temperature anomaly in a stable atmosphere with a horizontal wind.  Second, following \textcite{straka1993}, a cold bubble sinks to the ground, creating a density current that travels horizontally.  Results of both tests should be compared with reference solutions from \textcite{skamarock-klemp1994} and the results of \textcite{jebens2011}.

\section{Advection scheme}
\label{sec:further-work:advection}

For the three advection tests described in sections~\ref{sec:advection}, \ref{sec:wobblyTracerAdvection} and \ref{sec:wobblyThetaAdvection}, the standard OpenFOAM advection solver was used, which has two shortcomings.  First, whilst advection is treated explicitly in the fully-compressible model from \textcite{weller-shahrokhi2014}, the scalar transport model solves the advection equation (equation~\ref{eq:advection:continuous}) using an implicit scheme.  Second, the velocity fields for the three advection tests had velocities stored at cell centres.  The scalar transport model introduces additional error when velocities are linearly interpolated onto cell faces during model initialisation\footnote{For details, refer to \url{https://github.com/OpenFOAM/OpenFOAM-2.3.x/blob/9fd0db/src/finiteVolume/cfdTools/incompressible/createPhi.H}}.

To avoid these two issues, a custom scalar transport model should be implemented the solves advection explicitly and accepts a field in which velocities are defined at cell faces.  This has the added advantage that any velocity field from any fully-compressible simulation, such as the gravity waves test from section~\ref{sec:gw}, can be used as the prescribed velocity field for an advection test.

The upwind-biased cubic advection scheme, described in section~\ref{sec:method:discretisation}, is not monotonic.  Results from horizontal and terrain following tracer advection tests showed that tracer magnitude decreased over time (see sections~\ref{sec:advection} and \ref{sec:wobblyTracerAdvection}).
In similar tracer advection experiments, \textcite{jones2013} found that the van Leer scheme gave most accurate results.  The scheme is designed to maximise boundedness and accuracy, blending a centred difference scheme that is second-order accurate and unbounded with an upwind scheme that is first-order accurate and bounded.  This motivates the development of a monotonicity preserving version of the upwind-biased cubic advection scheme.  Due to its larger stencil size, we would expect such a scheme to have greater accuracy compared to the current upwind-biased scheme, and the van Leer scheme used by \textcite{jones2013}.

\section{Resting atmosphere errors}
\label{sec:further-work:resting}

Three findings from the resting atmosphere test (section~\ref{sec:resting}) have yet to be understood.  First, compared to the results of \textcite{good2013}, the maximum vertical velocity on a regular grid is larger than expected (figure~\ref{fig:resting:w:model}) which may be due to loss of precision when loading the initial conditions.
Second, computational oscillations in vertical velocity were found on the BTF grid which eventually lead to numerical instability (not shown).  This error has not been seen on any other grid.
Third, whilst total energy gradually decreased on the SnapCol and regular grids, some energy gain was seen on the BTF and optimised SLEVE grids.  Given that energy continued to increase on the BTF grid, we would expect this to contribute to the numerical instability.

Further work is required using longer integration times to diagnose the errors in this test.  Additionally, a further test of a neutrally stable atmosphere at rest by \textcite{botta2004} found that errors were close to machine precision but that errors increased when stratification was included.  Comparisons with this test would be useful to further explore the sources of numerical error in idealised resting atmospheres.

\section{Gravity waves and potential temperature errors}
\label{sec:further-work:gw}

The results of terrain following advection of a stable thermal profile (section~\ref{sec:wobblyThetaAdvection}) showed a different potential temperature error structure compared to those on the SnapCol grid in the gravity waves test (section~\ref{sec:gw}).  These results could be different because the velocity fields in the two tests are not the same.  Instead of a prescribing an idealised, non-divergent velocity field, a further advection test might be developed that uses the velocity field from the gravity waves simulation.  The custom transport model discussed earlier in this chapter would aid the development of such a test.  Using a more physical velocity field we hope that the new advection test would produce the same potential temperature error structure as the errors on the SnapCol grid in the gravity waves test.

To further investigate the Lorenz computational mode found on the SnapCol grid in the gravity waves test, a Charney--Phillips staggering should be formulated and implemented for unstructured grids.  We hypothesize that the potential temperature errors near the ground on the lee slope would be reduced on a Charney--Phillips grid.

Little evidence of the small cell problem was found in the gravity waves test.  The Courant number was shown to be independent of horizontal velocity and, because flow is near-horizontal in the gravity waves test, this was why there was no small cell problem.  To confirm this hypothesis, another test might be constructed in which a cold thermal anomaly descends to the ground, similar to the rising bubble test used in several other studies \parencites{bonaventura2000}{jebens2011}{good2013}.  The vertical momentum that reaches the ground should, for a sufficiently large timestep, cause numerical instability on the SnapCol grid but a stable solution on terrain following grids.  This would motivate the merging of small cells following \textcite{yamazaki-satomura2010}.

All tests presented in this project use one of two wave-shaped mountain profiles (given by equations~\ref{eqn:advection:schaerCos} and \ref{eqn:resting:mountain}).  Many experiments on cut cell grids perform simulations over bell-shaped mountain profiles known as `Witch of Agnessi' \parencites{steppeler2002}{rosatti2005}{klein2009}{jebens2011}.  Following \textcite{gallus-klemp2000}, a further test should be developed to simulate flow over a the bell-shaped mountain profile to allow comparison with existing results.

\textcite{lock2012} extended the two-dimensional test from \textcite{gallus-klemp2000} to simulate flow over a three dimensional mountain, presenting results on a cut cell grid.  Though substantial work will be required to implement a three dimensional shaving technique, it would be valuable to compare model results for terrain following and cut cell grids in three dimensions.

\TODO{resting atmosphere: 4km high mountains for resting atmosphere test. (or I might just do this myself if I have time)}

