\chapter{Further work}

In order to compare results with those from other experiments, such as \textcite{good2013}, the SnapCol grid should be improved so that all cut cells are aligned in columns.  As discussed in section~\ref{sec:method:grid}, some cells that intersect the surface are slightly distorted during the construction of the SnapCol grid.

For the three advection tests described in sections~\ref{sec:advection}, \ref{sec:wobblyTracerAdvection} and \ref{sec:wobblyThetaAdvection}, the standard OpenFOAM advection solver was used, which has two shortcomings.  First, whilst advection is treated explicitly in the fully-compressible model from \textcite{weller-shahrokhi2014}, the scalar transport model solves the advection equation (equation~\ref{eq:advection:continuous}) using an implicit scheme.  Second, the velocity fields presented in the three advection tests had velocities stored at cell centres.  The scalar transport model introduces additional errors when velocities are linearly interpolated onto cell faces during the initialisation phase\footnote{for details, refer to \url{https://github.com/OpenFOAM/OpenFOAM-2.3.x/blob/9fd0db/src/finiteVolume/cfdTools/incompressible/createPhi.H}}.

To avoid these two issues, a custom scalar transport model should be implemented the solves advection explicitly and accepts a field in which velocities are defined at cell faces.  This has the added advantage that any velocity field from any fully-compressible simulation, such as the gravity waves test from section~\ref{sec:gw}, can be used as the prescribed velocity field for an advection test.

The upwind-biased cubic advection scheme, described in section~\ref{sec:method:discretisation}, is not monotonic.  Results from horizontal and terrain following tracer advection tests showed that tracer magnitude decreased over time (see sections~\ref{sec:advection} and \ref{sec:wobblyTracerAdvection}).
In similar tracer advection experiments, \textcite{jones2013} found that the van Leer scheme gave most accurate results.  The scheme is designed to maximise boundedness and accuracy, blending a centred difference scheme that is second-order accurate and unbounded with an upwind scheme that is first-order accurate and bounded.  This motivates the development of a monotonicity preserving version of the upwind-biased cubic advection scheme.  Due to its larger stencil size, we would expect such a scheme to increase accuracy compared to the current upwind-biased scheme, and the van Leer scheme used by \textcite{jones2013}.

% gravity waves

To further investigate the Lorenz computational mode found on the SnapCol grid in the gravity waves test (section~\ref{sec:gw}), a Charney--Phillips staggering should be formulated and implemented for unstructured grids.  We hypothesize that the potential temperature errors near the ground on the lee slope would be reduced on a Charney--Phillips grid.


Little evidence of the small cell problem was found in the gravity waves test.  The Courant number was shown to be independent of horizontal velocity and, because flow is near-horizontal in the gravity waves test, this was why there was no small cell problem.  To confirm this hypothesis, another test might be constructed in which a cold thermal anomaly descends to the ground, similar to the rising bubble test used in several other studies \parencites{bonaventura2000}{jebens2011}{good2013}.  The vertical momentum that reaches the ground should, for a sufficiently large timestep, cause numerical instability on the SnapCol grid but a stable solution on terrain following grids.  This would motivate the merging of small cells following \textcite{yamazaki-satomura2010}.

% 3D tests

\begin{itemize}
\item mathematically investigate effects of metric term, try to show they're equivalent
\item interpolate velocity field from TF GW test and prescribe that flow for a wobbly advection test
\item advection: develop monotonic advection scheme, motivated by results of min/max tracer values
\item resting atmosphere: errors on regular grid should be lower
\item resting atmosphere: energy oscillations and increases
\item resting atmosphere: 4km high mountains for resting atmosphere test.
\item three dimensions (what kind of tests?  \textcite{lock2012} did some 3D tests that we could compare against.  I read a bit about 3D gravity waves in Topographic effects in stratified flows, Baines 1995) 
\item agnesi profile for comparison with cut cell test results
\end{itemize}
